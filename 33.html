<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Flappy Bird - Ø¥ØµØ¯Ø§Ø± Ù…ØªÙ‚Ø¯Ù…</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #87CEEB, #98FB98);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .game-container {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        canvas {
            border: 3px solid #fff;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
        }
        
        .ui-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            gap: 20px;
        }
        
        .stats {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .hacks {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }
        
        .hack-btn {
            background: linear-gradient(45deg, #9b59b6, #e74c3c);
            border: none;
            color: white;
            padding: 8px 16px;
            font-size: 12px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            opacity: 0.8;
        }
        
        .hack-btn:hover {
            transform: scale(1.1);
            opacity: 1;
        }
        
        .hack-btn.active {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            animation: glow 1s infinite alternate;
        }
        
        @keyframes glow {
            0% { box-shadow: 0 0 5px #2ecc71; }
            100% { box-shadow: 0 0 20px #2ecc71, 0 0 30px #2ecc71; }
        }
        
        .controls {
            margin-top: 15px;
            color: white;
            font-size: 16px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .shop-overlay, .level-select-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .shop-content, .level-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            color: white;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .shop-item {
            background: rgba(255, 255, 255, 0.1);
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .item-info {
            text-align: right;
        }
        
        .item-price {
            font-size: 18px;
            font-weight: bold;
            color: #FFD700;
        }
        
        .buy-btn {
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .buy-btn:hover {
            transform: scale(1.05);
        }
        
        .buy-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .close-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .level-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: none;
            color: white;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s;
        }
        
        .level-btn:hover {
            transform: scale(1.1);
        }
        
        .level-btn.locked {
            background: #666;
            cursor: not-allowed;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            font-size: 20px;
            display: none;
        }
        
        .menu-btns {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .menu-btn {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            color: white;
            padding: 10px 20px;
            font-size: 14px;
            border-radius: 20px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .menu-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="ui-panel">
            <div class="stats">
                <div>Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
                <div>Ø§Ù„ÙƒÙˆÙŠÙ†Ø²: <span id="coins">0</span> ğŸª™</div>
                <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="level">1</span></div>
            </div>
            <div class="hacks">
                <button class="hack-btn" id="godModeBtn" onclick="toggleGodMode()">ğŸ›¡ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù†</button>
                <button class="hack-btn" id="slowTimeBtn" onclick="toggleSlowTime()">â° Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†</button>
                <button class="hack-btn" id="coinMagnetBtn" onclick="toggleCoinMagnet()">ğŸ§² Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²</button>
            </div>
        </div>
        <canvas id="gameCanvas" width="400" height="600"></canvas>
        <div class="controls">
            ğŸ¦ Ø§Ø¶ØºØ· Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø·ÙŠØ±Ø§Ù†! ğŸ¦<br>
            <small>â­ Ø§Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆÙŠÙ†Ø² ÙˆØ§Ø´ØªØ± Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ÙƒØ³! â­</small>
        </div>
        <div class="menu-btns">
            <button class="menu-btn" onclick="showShop()">ğŸ›’ Ø§Ù„Ù…ØªØ¬Ø±</button>
            <button class="menu-btn" onclick="showLevelSelect()">ğŸ¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰</button>
            <button class="menu-btn" onclick="resetProgress()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
        </div>
        
        <!-- Ù†Ø§ÙØ°Ø© Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© -->
        <div class="game-over" id="gameOver">
            <h2>Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ’¥</h2>
            <p>Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="finalScore">0</span></p>
            <p>Ø§Ù„ÙƒÙˆÙŠÙ†Ø² Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©: <span id="coinsEarned">0</span> ğŸª™</p>
            <button class="menu-btn" onclick="restartGame()">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ğŸ®</button>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ØªØ¬Ø± -->
    <div class="shop-overlay" id="shopOverlay">
        <div class="shop-content">
            <h2>ğŸ›’ Ù…ØªØ¬Ø± Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª</h2>
            <p>Ø§Ù„ÙƒÙˆÙŠÙ†Ø² Ø§Ù„Ù…ØªØ§Ø­Ø©: <span id="shopCoins">0</span> ğŸª™</p>
            
            <div class="shop-item">
                <div class="item-info">
                    <h3>ğŸ›¡ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù† Ø§Ù„Ø¯Ø§Ø¦Ù…</h3>
                    <p>Ù„Ø§ ØªÙ…ÙˆØª Ø£Ø¨Ø¯Ø§Ù‹! (Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§ Ù…Ø­Ø¯ÙˆØ¯)</p>
                    <div class="item-price">500 ğŸª™</div>
                </div>
                <button class="buy-btn" onclick="buyItem('godModePermanent', 500)" id="buyGodMode">Ø´Ø±Ø§Ø¡</button>
            </div>
            
            <div class="shop-item">
                <div class="item-info">
                    <h3>â° Ù‚ÙˆØ© Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†</h3>
                    <p>Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù† Ù„Ù…Ø¯Ø© 15 Ø«Ø§Ù†ÙŠØ©! (Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§ Ù…Ø­Ø¯ÙˆØ¯)</p>
                    <div class="item-price">350 ğŸª™</div>
                </div>
                <button class="buy-btn" onclick="buyItem('slowTimePower', 350)" id="buySlowTime">Ø´Ø±Ø§Ø¡</button>
            </div>
            
            <div class="shop-item">
                <div class="item-info">
                    <h3>ğŸ§² Ù…ØºÙ†Ø§Ø·ÙŠØ³ ÙƒÙˆÙŠÙ†Ø² Ù‚ÙˆÙŠ</h3>
                    <p>Ø¬Ø°Ø¨ Ù‚ÙˆÙŠ + ÙƒÙˆÙŠÙ†Ø² Ù…Ø¶Ø§Ø¹ÙØ© + Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§ Ù…Ø­Ø¯ÙˆØ¯</p>
                    <div class="item-price">400 ğŸª™</div>
                </div>
                <button class="buy-btn" onclick="buyItem('superMagnet', 400)" id="buySuperMagnet">Ø´Ø±Ø§Ø¡</button>
            </div>
            
            <div class="shop-item">
                <div class="item-info">
                    <h3>âš¡ Ù†Ù‚Ø§Ø· Ù…Ø¶Ø§Ø¹ÙØ©</h3>
                    <p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¶Ø¹Ù Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ù† Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨!</p>
                    <div class="item-price">300 ğŸª™</div>
                </div>
                <button class="buy-btn" onclick="buyItem('doublePoints', 300)" id="buyDoublePoints">Ø´Ø±Ø§Ø¡</button>
            </div>
            
            <div class="shop-item">
                <div class="item-info">
                    <h3>ğŸ¨ Ø·Ø§Ø¦Ø± Ø°Ù‡Ø¨ÙŠ</h3>
                    <p>Ø´ÙƒÙ„ Ø£Ù†ÙŠÙ‚ + 50% ÙƒÙˆÙŠÙ†Ø² Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù† ÙƒÙ„ Ø¹Ù…Ù„Ø©</p>
                    <div class="item-price">250 ğŸª™</div>
                </div>
                <button class="buy-btn" onclick="buyItem('goldenBird', 250)" id="buyGoldenBird">Ø´Ø±Ø§Ø¡</button>
            </div>
            
            <button class="close-btn" onclick="closeShop()">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ -->
    <div class="level-select-overlay" id="levelSelectOverlay">
        <div class="level-content">
            <h2>ğŸ¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰</h2>
            <div id="levelButtons">
                <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            <button class="close-btn" onclick="closeLevelSelect()">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const coinsElement = document.getElementById('coins');
        const levelElement = document.getElementById('level');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const coinsEarnedElement = document.getElementById('coinsEarned');

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        let gameRunning = false;
        let gameStarted = false;
        let score = 0;
        let totalCoins = parseInt(localStorage.getItem('totalCoins') || '0');
        let currentLevel = 1;
        let coinsThisRound = 0;
        
        // Ø§Ù„Ù‡Ø§ÙƒØ³
        let godMode = false;
        let slowTime = false;
        let coinMagnet = false;
        let godModeTimer = 0;
        let slowTimeTimer = 0;
        let coinMagnetTimer = 0;
        
        // Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±Ø§Ø©
        let upgrades = JSON.parse(localStorage.getItem('upgrades') || '{}');
        let unlockedLevels = parseInt(localStorage.getItem('unlockedLevels') || '1');
        
        // Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
        let countdown = 0;
        let countdownActive = false;
        
        // Ø§Ù„Ø·Ø§Ø¦Ø±
        const bird = {
            x: 80,
            y: canvas.height / 2,
            radius: 20,
            velocity: 0,
            gravity: 0.4,
            jumpForce: -8,
            color: upgrades.goldenBird ? '#FFD700' : '#FF6B6B'
        };

        // Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨ ÙˆØ§Ù„ÙƒÙˆÙŠÙ†Ø²
        let pipes = [];
        let coins = [];
        const pipeWidth = 60;
        let pipeGap = 180;
        let pipeSpeed = 1.5;

        // Ø§Ù„Ø£Ù„ÙˆØ§Ù†
        const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8'];

        // Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø¹ Ø´Ø±ÙˆØ· ÙˆØ§Ø¶Ø­Ø©
        const levels = {
            1: { gap: 200, speed: 1.0, name: "Ù…Ø¨ØªØ¯Ø¦", requirement: "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨!" },
            2: { gap: 180, speed: 1.3, name: "Ù…ØªÙˆØ³Ø·", requirement: "ØªÙˆØµÙ„ Ù„Ù€ 20 Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1" },
            3: { gap: 160, speed: 1.6, name: "ØµØ¹Ø¨", requirement: "ØªÙˆØµÙ„ Ù„Ù€ 35 Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2" },
            4: { gap: 140, speed: 2.0, name: "Ø®Ø¨ÙŠØ±", requirement: "ØªÙˆØµÙ„ Ù„Ù€ 50 Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3" },
            5: { gap: 120, speed: 2.5, name: "Ù…Ø³ØªØ­ÙŠÙ„", requirement: "ØªÙˆØµÙ„ Ù„Ù€ 70 Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 4" }
        };

        // Ø§Ù„Ø£ØµÙˆØ§Øª
        const sounds = { jump: null, coin: null, gameOver: null, countdown: null };
        let audioContext;
        
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                createSounds();
            } catch (e) {
                console.log('Audio not supported');
            }
        }
        
        function createSounds() {
            sounds.jump = createBeep(300, 0.1, 'sine');
            sounds.coin = createBeep(800, 0.2, 'square');
            sounds.gameOver = createBeep(150, 0.5, 'sawtooth');
            sounds.countdown = createBeep(600, 0.3, 'triangle');
        }
        
        function createBeep(frequency, duration, waveType = 'sine') {
            return () => {
                if (!audioContext) return;
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.frequency.value = frequency;
                oscillator.type = waveType;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            };
        }
        
        function playSound(soundName) {
            if (sounds[soundName]) {
                try { sounds[soundName](); } catch (e) {}
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª
        function createPipe() {
            const minHeight = 50;
            const maxHeight = canvas.height - pipeGap - minHeight;
            const topHeight = Math.random() * (maxHeight - minHeight) + minHeight;
            
            return {
                x: canvas.width,
                topHeight: topHeight,
                bottomY: topHeight + pipeGap,
                bottomHeight: canvas.height - (topHeight + pipeGap),
                color: colors[Math.floor(Math.random() * colors.length)],
                passed: false
            };
        }

        function createCoin() {
            return {
                x: canvas.width + Math.random() * 200,
                y: Math.random() * (canvas.height - 200) + 100,
                radius: 15,
                collected: false,
                rotation: 0,
                pulseScale: 1
            };
        }

        // Ø±Ø³Ù… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª
        function drawBird() {
            ctx.save();
            ctx.translate(bird.x, bird.y);
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù†
            if (godMode) {
                ctx.shadowColor = '#00ff00';
                ctx.shadowBlur = 20;
            }
            
            ctx.fillStyle = bird.color;
            ctx.beginPath();
            ctx.arc(0, 0, bird.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ø¹ÙŠÙ†
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(-5, -5, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ù…Ù†Ù‚Ø§Ø±
            ctx.fillStyle = '#FF6B00';
            ctx.beginPath();
            ctx.moveTo(15, 0);
            ctx.lineTo(25, -5);
            ctx.lineTo(25, 5);
            ctx.closePath();
            ctx.fill();
            
            // Ø§Ù„Ø¬Ù†Ø§Ø­
            ctx.fillStyle = upgrades.goldenBird ? '#FFB347' : '#FF8C8C';
            ctx.beginPath();
            ctx.ellipse(-8, 2, 12, 8, Math.PI * 0.1, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }

        function drawPipes() {
            pipes.forEach(pipe => {
                const gradient1 = ctx.createLinearGradient(pipe.x, 0, pipe.x + pipeWidth, 0);
                gradient1.addColorStop(0, pipe.color);
                gradient1.addColorStop(1, adjustColor(pipe.color, -30));
                
                ctx.fillStyle = gradient1;
                ctx.fillRect(pipe.x, 0, pipeWidth, pipe.topHeight);
                
                const gradient2 = ctx.createLinearGradient(pipe.x, pipe.bottomY, pipe.x + pipeWidth, canvas.height);
                gradient2.addColorStop(0, pipe.color);
                gradient2.addColorStop(1, adjustColor(pipe.color, -30));
                
                ctx.fillStyle = gradient2;
                ctx.fillRect(pipe.x, pipe.bottomY, pipeWidth, pipe.bottomHeight);
                
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.strokeRect(pipe.x, 0, pipeWidth, pipe.topHeight);
                ctx.strokeRect(pipe.x, pipe.bottomY, pipeWidth, pipe.bottomHeight);
                
                ctx.fillStyle = adjustColor(pipe.color, 20);
                ctx.fillRect(pipe.x - 5, pipe.topHeight - 30, pipeWidth + 10, 30);
                ctx.fillRect(pipe.x - 5, pipe.bottomY, pipeWidth + 10, 30);
                
                ctx.strokeRect(pipe.x - 5, pipe.topHeight - 30, pipeWidth + 10, 30);
                ctx.strokeRect(pipe.x - 5, pipe.bottomY, pipeWidth + 10, 30);
            });
        }

        function drawCoins() {
            coins.forEach(coin => {
                if (coin.collected) return;
                
                ctx.save();
                ctx.translate(coin.x, coin.y);
                ctx.rotate(coin.rotation);
                ctx.scale(coin.pulseScale, coin.pulseScale);
                
                // ØªØ£Ø«ÙŠØ± Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²
                if (coinMagnet || upgrades.superMagnet) {
                    ctx.shadowColor = '#FFD700';
                    ctx.shadowBlur = 15;
                }
                
                const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, coin.radius);
                gradient.addColorStop(0, '#FFD700');
                gradient.addColorStop(0.7, '#FFA500');
                gradient.addColorStop(1, '#FF8C00');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(0, 0, coin.radius, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.strokeStyle = '#B8860B';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#B8860B';
                ctx.font = 'bold 20px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('â˜…', 0, 0);
                
                ctx.restore();
            });
        }

        function drawBackground() {
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#98FB98');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            drawClouds();
            
            // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù‡Ø§ÙƒØ³
            if (slowTime) {
                ctx.fillStyle = 'rgba(0, 0, 255, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
        }

        function drawClouds() {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            drawCloud(100, 80, 40);
            drawCloud(300, 120, 35);
            drawCloud(200, 50, 45);
        }

        function drawCloud(x, y, size) {
            ctx.beginPath();
            ctx.arc(x, y, size, 0, Math.PI * 2);
            ctx.arc(x + size * 0.6, y, size * 0.8, 0, Math.PI * 2);
            ctx.arc(x + size * 1.2, y, size, 0, Math.PI * 2);
            ctx.arc(x + size * 1.8, y, size * 0.8, 0, Math.PI * 2);
            ctx.arc(x + size * 2.4, y, size, 0, Math.PI * 2);
            ctx.fill();
        }

        function adjustColor(color, amount) {
            const usePound = color[0] === '#';
            color = color.slice(usePound ? 1 : 0);
            const num = parseInt(color, 16);
            let r = (num >> 16) + amount;
            let b = (num >> 8 & 0x00FF) + amount;
            let g = (num & 0x0000FF) + amount;
            r = r > 255 ? 255 : r < 0 ? 0 : r;
            b = b > 255 ? 255 : b < 0 ? 0 : b;
            g = g > 255 ? 255 : g < 0 ? 0 : g;
            return (usePound ? '#' : '') + (g | (b << 8) | (r << 16)).toString(16);
        }

        // ÙØ­Øµ Ø§Ù„ØªØµØ§Ø¯Ù… - Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù† ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ù…Ø¹ Ø§Ù„ØªØ±Ù‚ÙŠØ© Ø§Ù„Ù…Ø´ØªØ±Ø§Ø©
        function checkCollision() {
            if (godMode && upgrades.godModePermanent) return false;
            
            if (bird.y + bird.radius > canvas.height || bird.y - bird.radius < 0) {
                return true;
            }
            
            for (let pipe of pipes) {
                if (bird.x + bird.radius > pipe.x && 
                    bird.x - bird.radius < pipe.x + pipeWidth) {
                    if (bird.y - bird.radius < pipe.topHeight || 
                        bird.y + bird.radius > pipe.bottomY) {
                        return true;
                    }
                }
            }
            
            return false;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø¹Ø¨Ø©
        function update() {
            if (!gameRunning) return;
            
            const currentSpeed = slowTime ? pipeSpeed * 0.5 : pipeSpeed;
            const gravityMultiplier = slowTime ? 0.5 : 1;
            
            bird.velocity += bird.gravity * gravityMultiplier;
            bird.y += bird.velocity * gravityMultiplier;
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ù‚ØªØ§Øª Ø§Ù„Ù‡Ø§ÙƒØ³
            if (godModeTimer > 0) {
                godModeTimer--;
                if (godModeTimer === 0) {
                    godMode = false;
                    const btn = document.getElementById('godModeBtn');
                    btn.classList.remove('active');
                    btn.textContent = 'ğŸ›¡ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù†';
                }
            }
            
            if (slowTimeTimer > 0) {
                slowTimeTimer--;
                if (slowTimeTimer === 0) {
                    slowTime = false;
                    const btn = document.getElementById('slowTimeBtn');
                    btn.classList.remove('active');
                    btn.textContent = 'â° Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†';
                }
            }
            
            if (coinMagnetTimer > 0) {
                coinMagnetTimer--;
                if (coinMagnetTimer === 0) {
                    coinMagnet = false;
                    const btn = document.getElementById('coinMagnetBtn');
                    btn.classList.remove('active');
                    btn.textContent = 'ğŸ§² Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²';
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨
            pipes.forEach((pipe, index) => {
                pipe.x -= currentSpeed;
                
                if (!pipe.passed && bird.x > pipe.x + pipeWidth) {
                    pipe.passed = true;
                    let pointsEarned = 1;
                    if (upgrades.doublePoints) pointsEarned *= 2;
                    score += pointsEarned;
                    scoreElement.textContent = score;
                }
                
                if (pipe.x + pipeWidth < 0) {
                    pipes.splice(index, 1);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙˆÙŠÙ†Ø²
            coins.forEach((coin, index) => {
                if (coin.collected) return;
                
                coin.x -= currentSpeed;
                coin.rotation += 0.1;
                coin.pulseScale = 1 + Math.sin(Date.now() * 0.01) * 0.1;
                
                // Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²
                if (coinMagnet || upgrades.superMagnet) {
                    const dx = bird.x - coin.x;
                    const dy = bird.y - coin.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const magnetRange = upgrades.superMagnet ? 100 : 60;
                    
                    if (distance < magnetRange) {
                        coin.x += dx * 0.1;
                        coin.y += dy * 0.1;
                    }
                }
                
                const dx = bird.x - coin.x;
                const dy = bird.y - coin.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                // ØªØ·Ø¨ÙŠÙ‚ Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø·Ø§Ø¦Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ
                if (distance < bird.radius + coin.radius) {
                    coin.collected = true;
                    let coinsEarned = 1;
                    if (upgrades.superMagnet) coinsEarned *= 2;
                    if (upgrades.goldenBird) coinsEarned = Math.ceil(coinsEarned * 1.5); // 50% Ø¥Ø¶Ø§ÙÙŠ
                    
                    totalCoins += coinsEarned;
                    coinsThisRound += coinsEarned;
                    score += 5;
                    scoreElement.textContent = score;
                    coinsElement.textContent = totalCoins;
                    playSound('coin');
                    saveProgress();
                }
                
                if (coin.x + coin.radius < 0) {
                    coins.splice(index, 1);
                }
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ø§Ø¨ÙŠØ¨ Ø¬Ø¯ÙŠØ¯Ø©
            if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 200) {
                pipes.push(createPipe());
            }
            
            // Ø¥Ø¶Ø§ÙØ© ÙƒÙˆÙŠÙ†Ø² Ø¬Ø¯ÙŠØ¯Ø©
            if (Math.random() < 0.015) {
                coins.push(createCoin());
            }
            
            if (checkCollision()) {
                gameOver();
            }
        }

        // Ø±Ø³Ù… ÙƒÙ„ Ø´ÙŠØ¡
        function draw() {
            drawBackground();
            drawPipes();
            drawCoins();
            drawBird();
        }

        // Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (!gameStarted && !countdownActive) {
                draw();
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = 'white';
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Ø§Ø¶ØºØ· Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù„Ù„Ø¨Ø¯Ø¡!', canvas.width / 2, canvas.height / 2);
                ctx.fillText('ğŸ¦', canvas.width / 2, canvas.height / 2 + 40);
            } else if (countdownActive) {
                draw();
                ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#FFD700';
                ctx.font = 'bold 80px Arial';
                ctx.textAlign = 'center';
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 3;
                
                if (countdown > 0) {
                    ctx.strokeText(countdown.toString(), canvas.width / 2, canvas.height / 2);
                    ctx.fillText(countdown.toString(), canvas.width / 2, canvas.height / 2);
                } else {
                    ctx.strokeText('Ø§Ø¨Ø¯Ø£!', canvas.width / 2, canvas.height / 2);
                    ctx.fillText('Ø§Ø¨Ø¯Ø£!', canvas.width / 2, canvas.height / 2);
                }
                
                ctx.font = '20px Arial';
                ctx.fillStyle = 'white';
                ctx.fillText('Ø§Ø³ØªØ¹Ø¯...', canvas.width / 2, canvas.height / 2 + 60);
            } else {
                update();
                draw();
            }
            
            requestAnimationFrame(gameLoop);
        }

        // Ø§Ù„Ù‡Ø§ÙƒØ³ - ÙƒÙ„Ù‡Ø§ Ù…Ù‚ÙÙˆÙ„Ø© Ø­ØªÙ‰ Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±
        function toggleGodMode() {
            if (!audioContext) initAudio();
            
            if (upgrades.godModePermanent) {
                godMode = !godMode;
                const btn = document.getElementById('godModeBtn');
                if (godMode) {
                    btn.classList.add('active');
                    btn.textContent = 'ğŸ›¡ï¸ Ù…ÙÙØ¹Ù‘Ù„!';
                    alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù† Ø§Ù„Ø¯Ø§Ø¦Ù…! ğŸ›¡ï¸');
                } else {
                    btn.classList.remove('active');
                    btn.textContent = 'ğŸ›¡ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù†';
                }
            } else {
                alert('ğŸ”’ ÙŠØ¬Ø¨ Ø´Ø±Ø§Ø¡ "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù† Ø§Ù„Ø¯Ø§Ø¦Ù…" Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± Ø£ÙˆÙ„Ø§Ù‹!\nØ§Ù„Ø³Ø¹Ø±: 500 ÙƒÙˆÙŠÙ† ğŸ’°');
                showShop();
            }
        }

        function toggleSlowTime() {
            if (!audioContext) initAudio();
            
            if (upgrades.slowTimePower) {
                slowTime = !slowTime;
                const btn = document.getElementById('slowTimeBtn');
                if (slowTime) {
                    slowTimeTimer = 900; // 15 Ø«Ø§Ù†ÙŠØ©
                    btn.classList.add('active');
                    btn.textContent = 'â° Ù…ÙÙØ¹Ù‘Ù„!';
                    alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ù‚ÙˆØ© Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†! â°');
                } else {
                    btn.classList.remove('active');
                    btn.textContent = 'â° Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†';
                }
            } else {
                alert('ğŸ”’ ÙŠØ¬Ø¨ Ø´Ø±Ø§Ø¡ "Ù‚ÙˆØ© Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†" Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± Ø£ÙˆÙ„Ø§Ù‹!\nØ§Ù„Ø³Ø¹Ø±: 350 ÙƒÙˆÙŠÙ† ğŸ’°');
                showShop();
            }
        }

        function toggleCoinMagnet() {
            if (!audioContext) initAudio();
            
            if (upgrades.superMagnet) {
                coinMagnet = !coinMagnet;
                const btn = document.getElementById('coinMagnetBtn');
                if (coinMagnet) {
                    coinMagnetTimer = 1800; // 30 Ø«Ø§Ù†ÙŠØ©
                    btn.classList.add('active');
                    btn.textContent = 'ğŸ§² Ù…ÙÙØ¹Ù‘Ù„!';
                    alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø² Ø§Ù„Ù‚ÙˆÙŠ! ğŸ§²');
                } else {
                    btn.classList.remove('active');
                    btn.textContent = 'ğŸ§² Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²';
                }
            } else {
                alert('ğŸ”’ ÙŠØ¬Ø¨ Ø´Ø±Ø§Ø¡ "Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø² Ø§Ù„Ù‚ÙˆÙŠ" Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± Ø£ÙˆÙ„Ø§Ù‹!\nØ§Ù„Ø³Ø¹Ø±: 400 ÙƒÙˆÙŠÙ† ğŸ’°');
                showShop();
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        function jump() {
            if (!gameStarted && !countdownActive) {
                startGame();
            } else if (gameRunning) {
                bird.velocity = bird.jumpForce;
                playSound('jump');
            }
        }

        function startGame() {
            if (!audioContext) initAudio();
            
            countdownActive = true;
            countdown = 3;
            gameOverElement.style.display = 'none';
            coinsThisRound = 0;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            const levelConfig = levels[currentLevel];
            pipeGap = levelConfig.gap;
            pipeSpeed = levelConfig.speed;
            
            const countdownInterval = setInterval(() => {
                playSound('countdown');
                countdown--;
                if (countdown === 0) {
                    clearInterval(countdownInterval);
                    countdownActive = false;
                    gameStarted = true;
                    gameRunning = true;
                    bird.y = canvas.height / 2;
                    bird.velocity = 0;
                    pipes = [];
                    coins = [];
                    pipes.push(createPipe());
                    score = 0;
                    scoreElement.textContent = score;
                }
            }, 600);
        }

        function gameOver() {
            gameRunning = false;
            finalScoreElement.textContent = score;
            coinsEarnedElement.textContent = coinsThisRound;
            gameOverElement.style.display = 'block';
            playSound('gameOver');
            
            // Ù†Ø¸Ø§Ù… ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ø¹ Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ø¶Ø­Ø©
            let levelUnlocked = false;
            
            // Ø´Ø±ÙˆØ· ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ù…Ø¹ Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ø¶Ø­Ø©
            if (currentLevel === 1 && score >= 20 && unlockedLevels === 1) {
                unlockedLevels = 2;
                levelUnlocked = true;
                alert(`ğŸ‰ Ù…Ù…ØªØ§Ø²! ÙˆØµÙ„Øª Ù„Ù€ ${score} Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1!\nğŸ”“ ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: Ù…ØªÙˆØ³Ø·`);
            } else if (currentLevel === 2 && score >= 35 && unlockedLevels === 2) {
                unlockedLevels = 3;
                levelUnlocked = true;
                alert(`ğŸ”¥ Ø±Ø§Ø¦Ø¹! ÙˆØµÙ„Øª Ù„Ù€ ${score} Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2!\nğŸ”“ ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: ØµØ¹Ø¨`);
            } else if (currentLevel === 3 && score >= 50 && unlockedLevels === 3) {
                unlockedLevels = 4;
                levelUnlocked = true;
                alert(`âš¡ Ù„Ø§ ÙŠÙØµØ¯Ù‚! ÙˆØµÙ„Øª Ù„Ù€ ${score} Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3!\nğŸ”“ ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 4: Ø®Ø¨ÙŠØ±`);
            } else if (currentLevel === 4 && score >= 70 && unlockedLevels === 4) {
                unlockedLevels = 5;
                levelUnlocked = true;
                alert(`ğŸ† Ø£Ø³Ø·ÙˆØ±ÙŠ! ÙˆØµÙ„Øª Ù„Ù€ ${score} Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 4!\nğŸ”“ ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: Ù…Ø³ØªØ­ÙŠÙ„!`);
            }
            
            // Ø±Ø³Ø§Ø¦Ù„ ØªØ´Ø¬ÙŠØ¹ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ÙŠÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            if (!levelUnlocked && currentLevel < 5) {
                const nextLevel = currentLevel + 1;
                const requiredScore = [0, 20, 35, 50, 70][nextLevel - 1];
                if (score < requiredScore) {
                    setTimeout(() => {
                        alert(`ğŸ’ª ØªØ­ØªØ§Ø¬ ${requiredScore - score} Ù†Ù‚Ø·Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù„ÙØªØ­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${nextLevel}!\nØ§Ù„Ù…Ø·Ù„ÙˆØ¨: ${requiredScore} Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${currentLevel}`);
                    }, 1500);
                }
            }
            
            if (levelUnlocked) {
                saveProgress();
            }
            
            // Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„ÙƒÙˆÙŠÙ†Ø² Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡
            let bonusCoins = 0;
            if (score >= 5) bonusCoins += 2;
            if (score >= 15) bonusCoins += 5;
            if (score >= 30) bonusCoins += 10;
            if (score >= 50) bonusCoins += 15;
            if (score >= 75) bonusCoins += 25;
            
            if (bonusCoins > 0) {
                totalCoins += bonusCoins;
                coinsElement.textContent = totalCoins;
                saveProgress();
                setTimeout(() => {
                    alert(`ğŸ’° Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡: ${bonusCoins} ÙƒÙˆÙŠÙ† Ø¥Ø¶Ø§ÙÙŠ!\nğŸ’³ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²: ${totalCoins}`);
                }, 2000);
            }
        }

        function restartGame() {
            gameStarted = false;
            gameRunning = false;
            countdownActive = false;
            countdown = 0;
            bird.y = canvas.height / 2;
            bird.velocity = 0;
            pipes = [];
            coins = [];
            score = 0;
            scoreElement.textContent = score;
            gameOverElement.style.display = 'none';
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù†ØµÙˆØµ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ù…Ø¯Ø© Ø§Ù„Ù‡Ø§ÙƒØ³
            if (godModeTimer === 0) {
                document.getElementById('godModeBtn').classList.remove('active');
                document.getElementById('godModeBtn').textContent = 'ğŸ›¡ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¢Ù…Ù†';
            }
            if (slowTimeTimer === 0) {
                document.getElementById('slowTimeBtn').classList.remove('active');
                document.getElementById('slowTimeBtn').textContent = 'â° Ø¨Ø·Ø¡ Ø§Ù„Ø²Ù…Ù†';
            }
            if (coinMagnetTimer === 0) {
                document.getElementById('coinMagnetBtn').classList.remove('active');
                document.getElementById('coinMagnetBtn').textContent = 'ğŸ§² Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²';
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ¬Ø±
        function showShop() {
            document.getElementById('shopCoins').textContent = totalCoins;
            document.getElementById('shopOverlay').style.display = 'flex';
            updateShopButtons();
        }

        function closeShop() {
            document.getElementById('shopOverlay').style.display = 'none';
        }

        function buyItem(itemType, price) {
            if (totalCoins >= price && !upgrades[itemType]) {
                totalCoins -= price;
                upgrades[itemType] = true;
                coinsElement.textContent = totalCoins;
                saveProgress();
                updateShopButtons();
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø³ÙŠÙ† ÙÙˆØ±Ø§Ù‹
                if (itemType === 'goldenBird') {
                    bird.color = '#FFD700';
                }
                
                alert('ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰');
            } else if (upgrades[itemType]) {
                alert('Ù„Ù‚Ø¯ Ø§Ø´ØªØ±ÙŠØª Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø³Ø¨Ù‚Ø§Ù‹!');
            } else {
                alert('Ù„Ø§ ØªÙ…Ù„Ùƒ ÙƒÙˆÙŠÙ†Ø² ÙƒØ§ÙÙŠØ©!');
            }
        }

        function updateShopButtons() {
            const items = ['godModePermanent', 'slowTimePower', 'superMagnet', 'doublePoints', 'goldenBird'];
            const prices = [500, 350, 400, 300, 250];
            
            items.forEach((item, index) => {
                const btn = document.querySelectorAll('.buy-btn')[index];
                if (upgrades[item]) {
                    btn.textContent = 'Ù…ÙØ´ØªØ±Ù‰ âœ…';
                    btn.disabled = true;
                    btn.style.background = '#27ae60';
                } else if (totalCoins < prices[index]) {
                    btn.disabled = true;
                    btn.textContent = `ØªØ­ØªØ§Ø¬ ${prices[index] - totalCoins} ÙƒÙˆÙŠÙ†`;
                    btn.style.background = '#e74c3c';
                } else {
                    btn.disabled = false;
                    btn.textContent = 'Ø´Ø±Ø§Ø¡';
                    btn.style.background = 'linear-gradient(45deg, #4ECDC4, #44A08D)';
                }
            });
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰
        function showLevelSelect() {
            document.getElementById('levelSelectOverlay').style.display = 'flex';
            createLevelButtons();
        }

        function closeLevelSelect() {
            document.getElementById('levelSelectOverlay').style.display = 'none';
        }

        function createLevelButtons() {
            const container = document.getElementById('levelButtons');
            container.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const btn = document.createElement('button');
                btn.className = 'level-btn';
                btn.innerHTML = `
                    <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${i} - ${levels[i].name}</div>
                    <small>${levels[i].requirement}</small>
                `;
                
                if (i <= unlockedLevels) {
                    btn.onclick = () => selectLevel(i);
                    if (i === currentLevel) {
                        btn.style.background = 'linear-gradient(45deg, #e74c3c, #c0392b)';
                    }
                } else {
                    btn.classList.add('locked');
                    btn.innerHTML += '<div>ğŸ”’</div>';
                }
                
                container.appendChild(btn);
            }
        }

        function selectLevel(level) {
            currentLevel = level;
            levelElement.textContent = currentLevel;
            closeLevelSelect();
            restartGame();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„
        function saveProgress() {
            localStorage.setItem('totalCoins', totalCoins.toString());
            localStorage.setItem('upgrades', JSON.stringify(upgrades));
            localStorage.setItem('unlockedLevels', unlockedLevels.toString());
        }

        function resetProgress() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…ØŸ')) {
                localStorage.clear();
                totalCoins = 0;
                upgrades = {};
                unlockedLevels = 1;
                currentLevel = 1;
                bird.color = '#FF6B6B';
                coinsElement.textContent = totalCoins;
                levelElement.textContent = currentLevel;
                restartGame();
            }
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateUI() {
            coinsElement.textContent = totalCoins;
            levelElement.textContent = currentLevel;
        }

        // Ø­Ø°Ù ÙƒÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                jump();
            }
            // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ© - ÙŠØ¬Ø¨ Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ¬Ù…Ø¹ Ø§Ù„ÙƒÙˆÙŠÙ†Ø²!
        });

        canvas.addEventListener('click', jump);
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            jump();
        });

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©
        updateUI();
        gameLoop();
    </script>
</body>
</html>